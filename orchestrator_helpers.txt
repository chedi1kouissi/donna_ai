
    def _update_interactions_log(self, client_id: str, meeting_date: str, meeting_type: str, summary: str):
        """Appends the new meeting to the interactions log so next PrepPack sees it."""
        log_path = os.path.join(Config.FAKE_DATA_PATH, client_id, "interactions_log.json")
        if not os.path.exists(log_path):
            return

        try:
            with open(log_path, "r", encoding="utf-8") as f:
                logs = json.load(f)
            
            # Prepend new interaction
            new_entry = {
                "date": meeting_date,
                "type": meeting_type,
                "summary": summary[:200] + "..." if len(summary) > 200 else summary,
                "outcome": "See Client Case for full minutes."
            }
            logs.insert(0, new_entry)
            
            with open(log_path, "w", encoding="utf-8") as f:
                json.dump(logs, f, indent=2)
        except Exception as e:
            logger.error(f"Failed to update interactions log: {e}")

    def _update_document_vault(self, client_id: str, minutes: str):
        """Simple heuristic to update doc status if mentioned in minutes."""
        vault_path = os.path.join(Config.FAKE_DATA_PATH, client_id, "document_vault_index.json")
        if not os.path.exists(vault_path):
            return

        lower_minutes = minutes.lower()
        if "reçu" not in lower_minutes and "received" not in lower_minutes:
            return

        try:
            with open(vault_path, "r", encoding="utf-8") as f:
                vault = json.load(f)

            updated = False
            # naive check: if minute says "received states financiers", mark as valid
            if "états financiers" in lower_minutes or "financial statements" in lower_minutes:
                # Find the Missing 2025 one
                for doc in vault.get("financial_docs", []):
                    if doc.get("status") == "Missing" and "2025" in doc.get("doc_name", ""):
                        doc["status"] = "Valid (Received)"
                        updated = True
            
            if updated:
                 with open(vault_path, "w", encoding="utf-8") as f:
                    json.dump(vault, f, indent=2)
        except Exception as e:
            logger.error(f"Failed to update doc vault: {e}")
